<div class="flex flex-col items-center flex-auto min-w-0 sm:justify-center">
  <div class="w-full px-4 py-8 sm:bg-card sm:w-auto sm:rounded-2xl sm:p-12 sm:shadow">
    <div class="w-full mx-auto max-w-80 sm:mx-0 sm:w-80">
      <div class="w-12">
        <img src="https://i.pinimg.com/736x/d7/01/28/d70128f665c0687a491a0bef962b4e72.jpg" />
      </div>

      <div class="mt-8 text-4xl font-extrabold leading-tight tracking-tight">
        Sign up
      </div>
      <div class="mt-0.5 flex items-baseline font-medium">
        <div>Already have an account?</div>
        <a class="ml-1 text-blue-500 hover:underline" [routerLink]="['/sign-in']">Sign in
        </a>
      </div>


      @if (showSuccessAlert) {
      <div
        class="flex items-center justify-between w-full px-4 py-3 mt-6 text-green-700 bg-green-100 border border-green-300 rounded">
        <div class="flex items-center">
          <span class="text-sm">Account created successfully! Please check your email to verify.</span>
        </div>
        <button (click)="showSuccessAlert = false" class="ml-2 text-green-600 hover:text-green-800"
          aria-label="Dismiss">
          <mat-icon class="text-lg">close</mat-icon>
        </button>
      </div>
      }

      @if (error$ | async; as error) {
      <div class="flex items-center w-full px-4 py-3 mt-6 text-red-700 bg-red-100 border border-red-300 rounded">
        <span class="text-sm">{{ error }}</span>
      </div>
      }

      <form class="mt-8" [formGroup]="signUpForm">
        <mat-form-field class="w-full">
          <mat-label>Full name</mat-label>
          <input id="name" matInput [formControlName]="'name'" />
        </mat-form-field>

        <mat-form-field class="w-full">
          <mat-label>Email address</mat-label>
          <input id="email" matInput [formControlName]="'email'" />
        </mat-form-field>

        <mat-form-field class="w-full">
          <mat-label>Password</mat-label>
          <input id="password" matInput type="password" [formControlName]="'password'" #passwordField />
          <button mat-icon-button type="button" (click)="
                            passwordField.type === 'password'
                                ? (passwordField.type = 'text')
                                : (passwordField.type = 'password')
                        " matSuffix>
            @if (passwordField.type === 'password') {
            <mat-icon fontIcon="visibility"></mat-icon>
            }
            @if (passwordField.type === 'text') {
            <mat-icon fontIcon="visibility_off"></mat-icon>
            }
          </button>
          <mat-error> Password is required </mat-error>
        </mat-form-field>


        <mat-form-field class="w-full">
          <mat-label>Confirm Password</mat-label>
          <input id="passwordConfirm" matInput type="password" [formControlName]="'passwordConfirm'"
            #passwordConfirmField>
          <button mat-icon-button type="button"
            (click)="passwordConfirmField.type === 'password' ? passwordConfirmField.type = 'text' : passwordConfirmField.type = 'password'"
            matSuffix>
            @if (passwordField.type === 'password') {
            <mat-icon fontIcon="visibility"></mat-icon>
            }
            @if (passwordField.type === 'text') {
            <mat-icon fontIcon="visibility_off"></mat-icon>
            }
          </button>
          <mat-error> Confirm password is required </mat-error>
        </mat-form-field>


        <div class="mt-1.5 inline-flex w-full items-end">
          <mat-checkbox class="-ml-2" [formControlName]="'agreements'" [color]="'primary'">
            <span>I agree with</span>
            <a class="ml-1 text-black-500 hover:underline" [routerLink]="['./']">Terms
            </a>
            <span>and</span>
            <a class="ml-1 text-black-500 hover:underline" [routerLink]="['./']">Privacy Policy
            </a>
          </mat-checkbox>
        </div>

        <button class="w-full mt-6 fuse-mat-button-large" mat-flat-button [color]="'primary'"
          [disabled]="(loading$ | async) || signUpForm.invalid" (click)="signUp()">
          @if (!(loading$ | async)) {
          <span>Create your account</span>
          }
          @if (loading$ | async) {
          <mat-progress-spinner [diameter]="24" [mode]="'indeterminate'"></mat-progress-spinner>
          }
        </button>
      </form>
    </div>
  </div>
</div>